(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{211:function(s,t,a){"use strict";a.r(t);var e=a(28),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"创建系统服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建系统服务"}},[s._v("#")]),s._v(" 创建系统服务")]),s._v(" "),a("p",[s._v("为了在树莓派启动时运行命令或程序，您可以将其添加为服务。完成此操作后，您可以从linux提示符下启动/停止。")]),s._v(" "),a("h2",{attrs:{id:"创建服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建服务"}},[s._v("#")]),s._v(" 创建服务")]),s._v(" "),a("p",[s._v("在您的树莓派上，为您的服务创建一个.service文件，例如：")]),s._v(" "),a("p",[s._v("myscript.service")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Unit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Description")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("My "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("After")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("network.target\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/bin/python3 -u main.py\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("WorkingDirectory")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/pi/myscript\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("StandardOutput")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("inherit\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("StandardError")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("inherit\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Restart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("User")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("pi\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Install"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("WantedBy")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("multi-user.target\n")])])]),a("p",[s._v("因此，在这种情况下，该服务将在包含要运行的python程序的工作目录"),a("code",[s._v("/home/pi/myscript")]),s._v("中运行"),a("code",[s._v("python3 -u main.py")]),s._v("。但您不仅限于Python程序：只需将ExecStart行更改为要从引导中运行的任何程序/脚本命令即可。")]),s._v(" "),a("p",[s._v("将此文件复制为根用户"),a("code",[s._v("/etc/systemd/system")]),s._v("，例如：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" myscript.service /etc/systemd/system/myscript.service\n")])])]),a("p",[s._v("复制完成后，您可以尝试使用以下命令启动服务：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo systemctl start myscript.service\n")])])]),a("p",[s._v("使用以下命令停止它：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo systemctl stop myscript.service\n")])])]),a("p",[s._v("当您对启动和停止应用感到满意时，可以使用以下命令在重新启动时自动启动它：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo systemctl enable myscript.service\n")])])]),a("p",[s._v("该"),a("code",[s._v("systemctl")]),s._v("命令还可以用于重新启动服务或从启动中禁用它！")]),s._v(" "),a("p",[s._v("要注意的一些事情：")]),s._v(" "),a("ul",[a("li",[s._v("事物开始的顺序取决于它们的依赖关系—在网络可用之后，该特定脚本应在启动过程中相当晚地开始")]),s._v(" "),a("li",[s._v("您可以根据需要配置不同的依赖关系和顺序。")])])])}),[],!1,null,null,null);t.default=r.exports}}]);